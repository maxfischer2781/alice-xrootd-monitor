#!/usr/bin/python
from xrdmonlib import interface

NICKS = (
    ('AliceMon', 'xrdmonlib.backend.apmon', 'AliceApMonBackend'),
    ('LogFile', 'xrdmonlib.backend.filepath', 'FileBackend'),
    ('CGIFile', 'xrdmonlib.backend.filepath', 'CGIFileBackend'),
    ('Filter', 'xrdmonlib.backend.transform', 'RegexFilter'),
    ('Rename', 'xrdmonlib.backend.transform', 'FormatTransform'),
)

if __name__ == '__main__':
    interface.CONFIG_HELP.add_nicknames(*NICKS)
    options = interface.CLI.parse_args()
    interface.cli_log_config(**vars(options))
    config_interface = interface.PyConfiguration(
        ('AliceMon', 'xrdmonlib.backend.apmon', 'AliceApMonBackend'),
        ('LogFile', 'xrdmonlib.backend.filepath', 'FileBackend'),
        ('CGIFile', 'xrdmonlib.backend.filepath', 'CGIFileBackend'),
        ('Filter', 'xrdmonlib.backend.transform', 'RegexFilter'),
        ('Rename', 'xrdmonlib.backend.transform', 'FormatTransform'),
    )
    monitor_core = config_interface.configure_core(options.config)
    monitor_core.run()
